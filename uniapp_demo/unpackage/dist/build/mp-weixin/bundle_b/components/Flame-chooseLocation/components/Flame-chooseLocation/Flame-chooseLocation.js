require('../../../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["bundle_b/components/Flame-chooseLocation/components/Flame-chooseLocation/Flame-chooseLocation"],{"41ff":function(e,t,n){"use strict";var a=n("a79b"),c=n.n(a);c.a},"9bb9":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){}));var a=function(){var e=this.$createElement;this._self._c},c=[]},a79b:function(e,t,n){},ad54:function(e,t,n){"use strict";n.r(t);var a=n("9bb9"),c=n("e305");for(var o in c)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return c[e]}))}(o);n("41ff");var r=n("f0c5"),i=Object(r["a"])(c["default"],a["b"],a["c"],!1,null,"d069b03a",null,!1,a["a"],void 0);t["default"]=i.exports},d83b:function(e,t,n){"use strict";(function(e){var a=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=a(n("2eee")),o=a(n("9523")),r=a(n("c973"));function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u={components:{},mixins:[],model:{event:"change"},props:{value:{},mapkey:{type:String,default:""},exact:{type:Boolean,default:!1}},data:function(){return{keyword:"",showPop:!1,showCancel:!1,map:{},initLoc:[],selectAdress:{},searchList:[]}},computed:{},watch:{value:function(e){this.showPop=e,e&&this.initCurrentLoc()}},created:function(){},onLoad:function(e){},onShow:function(){},mounted:function(){},methods:{focusInput:function(){this.showCancel=!0},hideCancel:function(){this.showCancel=!1,this.keyword="",this.selectAdress={};var e=this.initLoc[0].location,t=e.lat,n=e.lng;this.searchList=this.initLoc,this.map.setCenter(new TMap.LatLng(t,n))},changeSearch:function(e){var t=e.detail;t.value?this.searchLoc({keyword:encodeURI(t.value)}):this.searchList=[]},selectLoc:function(e){this.selectAdress=e;var t=e.location,n=t.lat,a=t.lng;this.map.setCenter(new TMap.LatLng(n,a))},requireFunc:function(){var e=arguments,t=this;return(0,r.default)(c.default.mark((function n(){var a,o;return c.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:{},o=e.length>1&&void 0!==e[1]?e[1]:"",n.abrupt("return",new Promise((function(e,n){var c=s({key:t.mapkey,output:"jsonp"},a),r="https://apis.map.qq.com".concat(o),i=-1===r.indexOf("?")?"?":"&",u="jsonpCB_".concat(Date.now());if(r+="".concat(i,"callback=").concat(u),c)for(var l in c)r+="&".concat(l,"=").concat(c[l]);var d=document.createElement("script");d.src=r,window[u]=function(t){t?e(t):n("没有返回数据"),delete window[u],document.body.removeChild(d)},d.addEventListener("error",(function(){n("接口返回数据失败"),delete window[u],document.body.removeChild(d)}),!1),document.body.appendChild(d)})));case 3:case"end":return n.stop()}}),n)})))()},initCurrentLoc:function(){var t=this;this.exact?"pc"==e.getSystemInfoSync().deviceType?this.getIpLoc():(console.log(22222222),e.getLocation({type:"gcj02",isHighAccuracy:!0,success:function(e){console.log("获取定位成功",e);var n=e.longitude,a=e.latitude,c="nearby(".concat(a,",").concat(n,",1000)");t.setLoc({boundary:c},1)},fail:function(e){console.log("获取定位失败",e),t.getIpLoc()}}),console.log(3333333333333)):this.getIpLoc()},getIpLoc:function(){var e=this;return(0,r.default)(c.default.mark((function t(){var n,a,o,r,i;return c.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.requireFunc({},"/ws/location/v1/ip");case 2:n=t.sent,0==n.status&&(a=n.result.location,o=a.lat,r=a.lng,i="nearby(".concat(o,",").concat(r,",1000)"),e.setLoc({boundary:i},1));case 4:case"end":return t.stop()}}),t)})))()},setLoc:function(e,t){var n=this;return(0,r.default)(c.default.mark((function a(){var o,r;return c.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return o=s({page_size:20,page_index:1},e),a.next=3,n.requireFunc(o,"/ws/place/v1/search");case 3:if(r=a.sent,0!=r.status){a.next=12;break}if(!r.data||!r.data.length){a.next=12;break}if(!t){a.next=11;break}if(n.initLoc=r.data,n.initMap(r.data[0].location),!n.selectAdress.id){a.next=11;break}return a.abrupt("return");case 11:n.searchList=r.data;case 12:case"end":return a.stop()}}),a)})))()},searchLoc:function(e){var t=this;return(0,r.default)(c.default.mark((function n(){var a,o;return c.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=s({page_size:20,page_index:1},e),n.next=3,t.requireFunc(a,"/ws/place/v1/suggestion");case 3:o=n.sent,0==o.status&&o.data&&o.data.length&&(t.searchList=o.data);case 5:case"end":return n.stop()}}),n)})))()},initMap:function(e){var t=this,n=e.lat,a=e.lng,c=this.selectAdress,o=c.id,r=c.location,i=o?new TMap.LatLng(r.lat,r.lng):new TMap.LatLng(n,a);this.map=new TMap.Map("container",{viewMode:"2D",zoom:15,center:i,showControl:!1}),this.map.on("dragend",(function(){t.changeDragend()})),this.map.on("dblclick",(function(){t.changeDragend()}))},changeDragend:function(){this.selectAdress={};var e=this.map.getCenter(),t=e.lat,n=e.lng,a="nearby(".concat(t,",").concat(n,",1000)");this.setLoc({boundary:a})},cancel:function(){this.$emit("change",!1)},confirm:function(){this.$emit("change",!1),this.$emit("confirm",this.selectAdress)}},filters:{}};t.default=u}).call(this,n("543d")["default"])},e305:function(e,t,n){"use strict";n.r(t);var a=n("d83b"),c=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=c.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'bundle_b/components/Flame-chooseLocation/components/Flame-chooseLocation/Flame-chooseLocation-create-component',
    {
        'bundle_b/components/Flame-chooseLocation/components/Flame-chooseLocation/Flame-chooseLocation-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("ad54"))
        })
    },
    [['bundle_b/components/Flame-chooseLocation/components/Flame-chooseLocation/Flame-chooseLocation-create-component']]
]);
