require('../../../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["bundle_b/components/Flame-chooseLocation/components/Flame-chooseLocation/Flame-chooseLocation"],{1399:function(e,t,n){"use strict";n.r(t);var c=n(1400),o=n(1402);for(var r in o)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(r);n(1404);var a,i=n(52),s=Object(i["default"])(o["default"],c["render"],c["staticRenderFns"],!1,null,"1798f9d2",null,!1,c["components"],a);s.options.__file="bundle_b/components/Flame-chooseLocation/components/Flame-chooseLocation/Flame-chooseLocation.vue",t["default"]=s.exports},1400:function(e,t,n){"use strict";n.r(t);var c=n(1401);n.d(t,"render",(function(){return c["render"]})),n.d(t,"staticRenderFns",(function(){return c["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return c["recyclableRender"]})),n.d(t,"components",(function(){return c["components"]}))},1401:function(e,t,n){"use strict";var c;n.r(t),n.d(t,"render",(function(){return o})),n.d(t,"staticRenderFns",(function(){return a})),n.d(t,"recyclableRender",(function(){return r})),n.d(t,"components",(function(){return c}));var o=function(){var e=this,t=e.$createElement;e._self._c},r=!1,a=[];o._withStripped=!0},1402:function(e,t,n){"use strict";n.r(t);var c=n(1403),o=n.n(c);for(var r in c)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return c[e]}))}(r);t["default"]=o.a},1403:function(e,t,n){"use strict";(function(e){var c=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=c(n(26)),r=c(n(11)),a=c(n(28));function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,c)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u={components:{},mixins:[],model:{event:"change"},props:{value:{},mapkey:{type:String,default:""},exact:{type:Boolean,default:!1}},data:function(){return{keyword:"",showPop:!1,showCancel:!1,map:{},initLoc:[],selectAdress:{},searchList:[]}},computed:{},watch:{value:function(e){this.showPop=e,e&&this.initCurrentLoc()}},created:function(){},onLoad:function(e){},onShow:function(){},mounted:function(){},methods:{focusInput:function(){this.showCancel=!0},hideCancel:function(){this.showCancel=!1,this.keyword="",this.selectAdress={};var e=this.initLoc[0].location,t=e.lat,n=e.lng;this.searchList=this.initLoc,this.map.setCenter(new TMap.LatLng(t,n))},changeSearch:function(e){var t=e.detail;t.value?this.searchLoc({keyword:encodeURI(t.value)}):this.searchList=[]},selectLoc:function(e){this.selectAdress=e;var t=e.location,n=t.lat,c=t.lng;this.map.setCenter(new TMap.LatLng(n,c))},requireFunc:function(){var e=arguments,t=this;return(0,a.default)(o.default.mark((function n(){var c,r;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return c=e.length>0&&void 0!==e[0]?e[0]:{},r=e.length>1&&void 0!==e[1]?e[1]:"",console.log("requireFunc param",c),n.abrupt("return",new Promise((function(e,n){var o=s({key:t.mapkey,output:"jsonp"},c),a="https://apis.map.qq.com".concat(r),i=-1===a.indexOf("?")?"?":"&",u="jsonpCB_".concat(Date.now());if(a+="".concat(i,"callback=").concat(u),o)for(var l in o)a+="&".concat(l,"=").concat(o[l]);var d=document.createElement("script");d.src=a,window[u]=function(t){t?e(t):n("没有返回数据"),delete window[u],document.body.removeChild(d)},d.addEventListener("error",(function(){n("接口返回数据失败"),delete window[u],document.body.removeChild(d)}),!1),document.body.appendChild(d)})));case 4:case"end":return n.stop()}}),n)})))()},initCurrentLoc:function(){var t=this;this.exact?"pc"==e.getSystemInfoSync().deviceType?this.getIpLoc():(console.log(22222222),e.getLocation({type:"gcj02",isHighAccuracy:!0,success:function(e){console.log("获取定位成功",e);var n=e.longitude,c=e.latitude,o="nearby(".concat(c,",").concat(n,",1000)");t.setLoc({boundary:o},1)},fail:function(e){console.log("获取定位失败",e),t.getIpLoc()}}),console.log(3333333333333)):this.getIpLoc()},getIpLoc:function(){var e=this;return(0,a.default)(o.default.mark((function t(){var n,c,r,a,i;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.requireFunc({},"/ws/location/v1/ip");case 2:n=t.sent,0==n.status&&(c=n.result.location,r=c.lat,a=c.lng,i="nearby(".concat(r,",").concat(a,",1000)"),e.setLoc({boundary:i},1));case 4:case"end":return t.stop()}}),t)})))()},setLoc:function(e,t){var n=this;return(0,a.default)(o.default.mark((function c(){var r,a;return o.default.wrap((function(c){while(1)switch(c.prev=c.next){case 0:return r=s({page_size:20,page_index:1,enableHighAccuracy:!0},e),c.next=3,n.requireFunc(r,"/ws/place/v1/search");case 3:if(a=c.sent,0!=a.status){c.next=12;break}if(!a.data||!a.data.length){c.next=12;break}if(!t){c.next=11;break}if(n.initLoc=a.data,n.initMap(a.data[0].location),!n.selectAdress.id){c.next=11;break}return c.abrupt("return");case 11:n.searchList=a.data;case 12:case"end":return c.stop()}}),c)})))()},searchLoc:function(e){var t=this;return(0,a.default)(o.default.mark((function n(){var c,r;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return c=s({page_size:20,page_index:1},e),n.next=3,t.requireFunc(c,"/ws/place/v1/suggestion");case 3:r=n.sent,0==r.status&&r.data&&r.data.length&&(t.searchList=r.data);case 5:case"end":return n.stop()}}),n)})))()},initMap:function(e){var t=this,n=e.lat,c=e.lng,o=this.selectAdress,r=o.id,a=o.location,i=r?new TMap.LatLng(a.lat,a.lng):new TMap.LatLng(n,c);this.map=new TMap.Map("container",{viewMode:"2D",zoom:15,center:i,showControl:!1}),this.map.on("dragend",(function(){t.changeDragend()})),this.map.on("dblclick",(function(){t.changeDragend()}))},changeDragend:function(){this.selectAdress={};var e=this.map.getCenter(),t=e.lat,n=e.lng,c="nearby(".concat(t,",").concat(n,",1000)");this.setLoc({boundary:c})},cancel:function(){this.$emit("change",!1)},confirm:function(){this.$emit("change",!1),this.$emit("confirm",this.selectAdress)}},filters:{}};t.default=u}).call(this,n(2)["default"])},1404:function(e,t,n){"use strict";n.r(t);var c=n(1405),o=n.n(c);for(var r in c)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return c[e]}))}(r);t["default"]=o.a},1405:function(e,t,n){}}]);
//# sourceMappingURL=../../../../../../.sourcemap/mp-weixin/bundle_b/components/Flame-chooseLocation/components/Flame-chooseLocation/Flame-chooseLocation.js.map
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'bundle_b/components/Flame-chooseLocation/components/Flame-chooseLocation/Flame-chooseLocation-create-component',
    {
        'bundle_b/components/Flame-chooseLocation/components/Flame-chooseLocation/Flame-chooseLocation-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('2')['createComponent'](__webpack_require__(1399))
        })
    },
    [['bundle_b/components/Flame-chooseLocation/components/Flame-chooseLocation/Flame-chooseLocation-create-component']]
]);
