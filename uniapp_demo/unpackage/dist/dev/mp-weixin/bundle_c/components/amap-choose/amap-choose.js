(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["bundle_c/components/amap-choose/amap-choose"],{1267:function(t,e,n){"use strict";n.r(e);var o=n(1268),c=n(1270);for(var a in c)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return c[t]}))}(a);n(1272);var i,s=n(52),r=Object(s["default"])(c["default"],o["render"],o["staticRenderFns"],!1,null,"1db9ec96",null,!1,o["components"],i);r.options.__file="bundle_c/components/amap-choose/amap-choose.vue",e["default"]=r.exports},1268:function(t,e,n){"use strict";n.r(e);var o=n(1269);n.d(e,"render",(function(){return o["render"]})),n.d(e,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(e,"components",(function(){return o["components"]}))},1269:function(t,e,n){"use strict";var o;n.r(e),n.d(e,"render",(function(){return c})),n.d(e,"staticRenderFns",(function(){return i})),n.d(e,"recyclableRender",(function(){return a})),n.d(e,"components",(function(){return o}));var c=function(){var t=this,e=t.$createElement;t._self._c},a=!1,i=[];c._withStripped=!0},1270:function(t,e,n){"use strict";n.r(e);var o=n(1271),c=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=c.a},1271:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={props:{color:{type:String,default:"#ff6000"},keyMap:{type:String,default:""},AMapKeyWeb:{type:String,default:""},initLocation:{type:String,default:""},show:{type:Boolean,default:!1}},data:function(){return{list:[],keyword:"",timeId:null,checked:{locaiton:""},showPlace:!1}},watch:{show:function(t,e){var n=this;this.showPlace=t,this.$nextTick((function(){n.loop()}))}},mounted:function(){this.showPlace=this.show;var t=document.getElementById("mapTest"),e=this;t?this.loop():function(){var t=document.createElement("script");t.type="text/javascript",t.setAttribute("id","mapTest"),t.src="https://webapi.amap.com/maps?v=2.0&key=".concat(e.keyMap),document.body.appendChild(t),e.loop()}()},methods:{loop:function(){var t=this;try{this.initMapWeb()}catch(e){setTimeout((function(){return t.loop()}),200)}},inputValue:function(t){var e=this;this.timeId&&clearTimeout(this.timeId),this.timeId=setTimeout((function(){e.getPlaces(t.detail.value,""),e.timeId=null}),300)},cancel:function(){this.keyword="",this.list=[],this.maker&&this.marker.setMap(null)},toCancel:function(){this.showPlace=!1,this.cancel(),this.$emit("changeShow",!1)},confrom:function(){if(console.log("完成-传递选择地址checked",this.checked),this.checked){var t;t=this.checked.addressLocal?this.checked.addressLocal:"".concat(this.checked.district).concat(this.checked.address?"-"+this.checked.address:"");var e=this.checked.location.split(",");this.$emit("placeChoose",{address:t,adcode:this.checked.adcode,latitude:e[1],longitude:e[0]}),this.showPlace=!1,this.cancel()}},toChecked:function(t){if(console.log("选择地址obj",t),this.marker){this.marker.setMap(null);var e=t.location.split(",");this.addMarker(e[0],e[1])}},initMapWeb:function(){var t=this,e=this;if(this.map=new AMap.Map("map",{center:["106.55","29.57"],zoom:18}),this.map.on("click",(function(n){t.marker&&t.marker.setMap(null),e.addMarker(n.lnglat.lng,n.lnglat.lat),e.getNearbyPlaces(n.lnglat.lng,n.lnglat.lat),e.getNowPlace("".concat(n.lnglat.lng,", ").concat(n.lnglat.lat))})),this.initLocation.length>0){var n=this.initLocation.split(",");return e.addMarker(n[0],n[1]),e.getNearbyPlaces(n[0],n[1]),void e.getNowPlace("".concat(n[0],", ").concat(n[1]))}AMap.plugin("AMap.Geolocation",(function(){var t=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,buttonOffset:new AMap.Pixel(10,20),zoomToAccuracy:!0,buttonPosition:"RB"});t.getCurrentPosition((function(t,n){console.log("高德地图定位经纬度result",n),"SUCCESS"==n.info&&n.position&&n.position&&(e.addMarker(n.position.lng,n.position.lat),e.getNowPlace("".concat(n.position.lng,", ").concat(n.position.lat)))}))}))},getNowPlace:function(e){var n=this,o=this;t.request({url:"https://restapi.amap.com/v3/geocode/regeo?key=".concat(this.AMapKeyWeb,"&location=").concat(e),method:"GET",success:function(t){var c=t.data;if(console.log("高德地图定位result",c),"1"==c.status){var a=c.regeocode;o.checked.adcode=a.addressComponent.adcode,o.checked.city=a.addressComponent.city,o.checked.district=a.addressComponent.district,o.checked.location=e,o.checked.addressLocal=a.formatted_address,console.log("高德地图定位checked",n.checked)}},fail:function(e){t.showToast({title:JSON.stringify(e),icon:"none"})}})},addMarker:function(t,e){var n=new AMap.Icon({image:"//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png",imageSize:new AMap.Size(32,42)});this.marker=new AMap.Marker({icon:n,position:[t,e]}),this.marker.setMap(this.map),this.map.setCenter([t,e])},getPlaces:function(e,n){var o=this;console.log("获取周边keywords",e,n),t.request({url:"https://restapi.amap.com/v3/assistant/inputtips?key=".concat(this.AMapKeyWeb,"&keywords=").concat(e,"&location=").concat(n),method:"GET",success:function(t){console.log("获取周边res",t);var e=t.data;"1"===e.status&&(o.list=e.tips.filter((function(t){return t.location&&t.location.length>0})),console.log(o.list,e.tips))},fail:function(e){console.error("获取周边err",e),t.showToast({title:JSON.stringify(e),icon:"none"})}})},getNearbyPlaces:function(e,n){var o=this,c="https://restapi.amap.com/v3/place/around?key=".concat(this.AMapKeyWeb,"&location=").concat(e,",").concat(n,"&output=JSON");console.log("获取周边nearbyUrl",c),t.request({url:c,method:"GET",success:function(t){var e=t.data;"1"===e.status&&(o.list=e.pois)},fail:function(e){console.error("获取周边err",e),t.showToast({title:JSON.stringify(e),icon:"none"})}})}}};e.default=n}).call(this,n(2)["default"])},1272:function(t,e,n){"use strict";n.r(e);var o=n(1273),c=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=c.a},1273:function(t,e,n){}}]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/bundle_c/components/amap-choose/amap-choose.js.map
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'bundle_c/components/amap-choose/amap-choose-create-component',
    {
        'bundle_c/components/amap-choose/amap-choose-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('2')['createComponent'](__webpack_require__(1267))
        })
    },
    [['bundle_c/components/amap-choose/amap-choose-create-component']]
]);
